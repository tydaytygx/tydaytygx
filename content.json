{"meta":{"title":"TYGX's blog","subtitle":"Welcome","description":null,"author":"TYGX","url":"http://yoursite.com"},"pages":[{"title":"TYGX","date":"2018-12-06T07:05:14.000Z","updated":"2018-12-06T07:05:14.797Z","comments":true,"path":"TYGX/index.html","permalink":"http://yoursite.com/TYGX/index.html","excerpt":"","text":""}],"posts":[{"title":"Steam_sale","slug":"Steam-sale","date":"2020-02-24T07:17:47.000Z","updated":"2020-02-24T12:37:54.077Z","comments":true,"path":"2020/02/24/Steam-sale/","link":"","permalink":"http://yoursite.com/2020/02/24/Steam-sale/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225import requestsimport urllibimport urllib.requestimport reimport osimport shutildef createFile(filePath): if os.path.exists(filePath): # If folder exists shutil.rmtree(&apos;img&apos;) else: # File doesn&apos;t exist print(&apos;No such file:%s&apos;% filePath) if os.path.exists(filePath): print(&apos;%s: exists&apos;%filePath) else: try: os.mkdir(filePath) print(&apos;New folder：%s&apos;%filePath) except Exception as e: os.makedirs(filePath) print(&apos;New multi-sub-folder：%s&apos; % filePath)def File_Checker(): # Check if output files exist or not if(os.path.exists(&apos;steam_sale.html&apos;)): os.remove(&apos;steam_sale.html&apos;) # Check html file elif(os.path.exists(&apos;steam_saleout.md&apos;)): os.remove(&apos;steam_saleout.md&apos;) # Check output file # STEAM_SPIDER def Steam_Spider(): page = 0 # This loop may not suit this site, use when necessary while(page &lt; 1): url = &apos;https://store.steampowered.com/specials#p=&apos;+ str(page)+ &apos;&amp;tab=TopSellers&apos; # Sale page header = &#123;&apos;user-agent&apos;: &apos;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36&apos;&#125; r = requests.get(url) r = requests.get(url, headers=header) content = r.text f = open(&apos;steam_sale.html&apos;,&apos;a&apos;, encoding = &apos;UTF-8&apos;, errors = &apos;ignore&apos;) print(r.text, file = f) f.close() print(&apos;Completed with &apos; + r.encoding) # Site &apos;s HTML encoding page = page + 1def getNonRepeatList(data): # No-repeat tool return [i for n, i in enumerate(data) if i not in data[:n]]def Output(): discount_img = [] discount_name = [] discount_original_price= [] discount_pct = [] discount_final_price =[] with open(&apos;steam_sale.html&apos;, &apos;r&apos;, encoding=&apos;UTF-8&apos;, errors=&apos;ignore&apos;) as f2: line = f2.readline() list1 = [] while line: try: line = f2.readline() if &apos;tab_item_name&apos; in line: print(re.findall(r&apos;&lt;div\\sclass=&quot;tab_item_name&quot;&gt;(.+?)&lt;/div&gt;&apos;, line)[0]) discount_name.append(re.findall(r&apos;&lt;div\\sclass=&quot;tab_item_name&quot;&gt;(.+?)&lt;/div&gt;&apos;, line)[0]) print(&apos;-----------------------------------------------------------------&gt;&gt;&gt;&apos;) elif &apos;tab_item_cap_img&apos; in line: print(re.findall(r&apos;tab_item_cap_img&quot;\\ssrc=&quot;(.+?)&quot;\\s&gt;&apos;, line)[0]) #img_url discount_img.append(re.findall(r&apos;tab_item_cap_img&quot;\\ssrc=&quot;(.+?)&quot;\\s&gt;&apos;, line)[0]) elif &apos;discount_block tab_item_discount&apos; in line: print(&apos;discount_original_price = &apos; + re.findall(r&apos;&lt;div\\sclass=&quot;discount_original_price&quot;&gt;(.+?)&lt;/div&gt;&apos;, line)[0]) print(&apos;discount_pct = &apos; + re.findall(r&apos;&lt;div\\sclass=&quot;discount_pct&quot;&gt;(.+?)&lt;/div&gt;&apos;, line)[0]) print(&apos;discount_final_price = &apos; + re.findall(r&apos;&lt;div\\sclass=&quot;discount_final_price&quot;&gt;(.+?)&lt;/div&gt;&apos;, line)[0]) discount_original_price.append(re.findall(r&apos;&lt;div\\sclass=&quot;discount_original_price&quot;&gt;(.+?)&lt;/div&gt;&apos;, line)[0]) discount_pct.append(re.findall(r&apos;&lt;div\\sclass=&quot;discount_pct&quot;&gt;(.+?)&lt;/div&gt;&apos;, line)[0]) discount_final_price.append(re.findall(r&apos;&lt;div\\sclass=&quot;discount_final_price&quot;&gt;(.+?)&lt;/div&gt;&apos;, line)[0]) except OSError: pass # Output as a file with open(&apos;steam_saleout.html&apos;, &apos;w&apos;, encoding = &apos;UTF-8&apos;, errors = &apos;ignore&apos;) as f3: print(r&apos;&apos;&apos; &lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot; /&gt; &lt;title&gt;&lt;/title&gt; &lt;style type=&quot;text/css&quot;&gt; *&#123; transition-duration: 0.5s; margin: 0; word-break: break-all; box-sizing: border-box; transition-duration: 0.5s; font-family: &quot;microsoft yahei&quot;; color: white; &#125; body&#123; background-color: #24292e; &#125; div:hover&#123; border: none; font-size: 20px; background-color: #5b5b5b; width: 100%; &#125; .discount_original_price&#123; background-color: cornflowerblue; width: 100%; background-color: #2894ff; border-radius: 5px 5px 5px 5px; &#125; .discount_pct&#123; background-color: cornflowerblue; width: 100%; background-color: #73bf00; border-radius: 5px 5px 5px 5px; &#125; .discount_final_price&#123; background-color: cornflowerblue; width: 100%; background-color: #ff8040; border-radius: 5px 5px 5px 5px; &#125; .hover_check&#123; display: block; background-color: #24292e; width: 0%; &#125; .hover_check:hover&#123; background-color: indianred; width: 100%; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt;&apos;&apos;&apos;, file = f3) for v in range(len(discount_name)): if &apos;/&apos; in discount_name[v]: urllib.request.urlretrieve(discount_img[v], &apos;img\\%s.jpg&apos; % discount_name[v].replace(&apos;/&apos;, &apos;&apos;)) # When using urlretrieve, the : makes files can&apos;t be save completely print(r&apos;&lt;div&gt;&lt;p class=&quot;hover_check hover_check:hover&quot;&gt;&lt;img src=&quot;img\\%s.jpg&quot; class=&quot;multiimage 3d_show&quot;/ &gt; &lt;/div&gt;&lt;/p&gt;&apos; % discount_name[v].replace(&apos;/&apos;, &apos;&apos;), file = f3) elif &apos;:&apos; in discount_name[v]: urllib.request.urlretrieve(discount_img[v], &apos;img\\%s.jpg&apos; % discount_name[v].replace(&apos;:&apos;, &apos;&apos;)) # When using urlretrieve, the : makes files can&apos;t be save completely print(r&apos;&lt;div&gt;&lt;p class=&quot;hover_check hover_check:hover&quot;&gt;&lt;img src=&quot;img\\%s.jpg&quot; class=&quot;multiimage 3d_show&quot;/ &gt; &lt;/div&gt;&lt;/p&gt;&apos; % discount_name[v].replace(&apos;:&apos;, &apos;&apos;), file = f3) elif &apos;|&apos; in discount_name[v]: urllib.request.urlretrieve(discount_img[v], &apos;img\\%s.jpg&apos; % discount_name[v].replace(&apos;|&apos;, &apos;&apos;)) # When using urlretrieve, the | makes files can&apos;t be save completely print(r&apos;&lt;div&gt;&lt;p class=&quot;hover_check hover_check:hover&quot;&gt;&lt;img src=&quot;img\\%s.jpg&quot; class=&quot;multiimage 3d_show&quot;/ &gt; &lt;/div&gt;&lt;/p&gt;&apos; % discount_name[v].replace(&apos;|&apos;, &apos;&apos;), file = f3) elif &apos;?&apos; in discount_name[v]: urllib.request.urlretrieve(discount_img[v], &apos;img\\%s.jpg&apos; % discount_name[v].replace(&apos;?&apos;, &apos;&apos;)) # When using urlretrieve, the | makes files can&apos;t be save completely print(r&apos;&lt;div&gt;&lt;p class=&quot;hover_check hover_check:hover&quot;&gt;&lt;img src=&quot;img\\%s.jpg&quot; class=&quot;multiimage 3d_show&quot;/ &gt; &lt;/div&gt;&lt;/p&gt;&apos; % discount_name[v].replace(&apos;|&apos;, &apos;&apos;), file = f3) elif &apos;,&apos; in discount_name[v]: urllib.request.urlretrieve(discount_img[v], &apos;img\\%s.jpg&apos; % discount_name[v].replace(&apos;,&apos;, &apos;&apos;)) # When using urlretrieve, the | makes files can&apos;t be save completely print(r&apos;&lt;div&gt;&lt;p class=&quot;hover_check hover_check:hover&quot;&gt;&lt;img src=&quot;img\\%s.jpg&quot; class=&quot;multiimage 3d_show&quot;/ &gt; &lt;/div&gt;&lt;/p&gt;&apos; % discount_name[v].replace(&apos;|&apos;, &apos;&apos;), file = f3) else: urllib.request.urlretrieve(discount_img[v], &apos;img\\%s.jpg&apos; % discount_name[v]) print(r&apos;&lt;div&gt;&lt;p class=&quot;hover_check hover_check:hover&quot;&gt;&lt;img src=&quot;img\\%s.jpg&quot; class=&quot;multiimage 3d_show&quot;/ &gt; &lt;/div&gt;&lt;/p&gt;&apos; % discount_name[v], file = f3) print(&apos;# &apos; + discount_name[v], file = f3) print(r&apos;&lt;b class=&quot;discount_original_price&quot; &gt;discount_original_price = %s&lt;/b&gt;&apos; % discount_original_price[v], file = f3) # Game&apos;s Discount_before, transformating would be a little bit slower than the others? print(r&apos;&lt;b class=&quot;discount_pct&quot; &gt;discount_pct = %s&lt;/b&gt;&apos; % discount_pct[v], file = f3) # Game&apos;s Discount print(r&apos;&lt;b class=&quot;discount_final_price&quot; &gt; discount_final_price = %s&lt;/b&gt;&apos; % discount_final_price[v], file = f3) # Game&apos;s Discounted # print(&apos;-------------------&apos;, file = f3) print(r&apos;&apos;&apos; &lt;/body&gt;&lt;/html&gt;&apos;&apos;&apos;, file = f3) print(&apos;done&apos;) if __name__ == &apos;__main__&apos;: createFile(os.getcwd() + &apos;\\img&apos;) File_Checker() Steam_Spider() Output()","categories":[],"tags":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/tags/Python/"}]},{"title":"starter page","slug":"starter-page","date":"2018-12-06T07:04:49.000Z","updated":"2018-12-07T16:02:48.923Z","comments":true,"path":"2018/12/06/starter-page/","link":"","permalink":"http://yoursite.com/2018/12/06/starter-page/","excerpt":"","text":"","categories":[],"tags":[]}]}